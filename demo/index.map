{"version":3,"sources":["index.js"],"names":["V","Vue","show","index","ajax","show_ajax","renderCatalog","renderList","renderBook","log","BookSource","show_index","searchIcon","searchInput","swichMybook","swichFind","activeMybook","activeFind","nobook","myBookList","find","$nextTick","$refs","focus","event","input","target","value","type","getAttribute","text","innerHTML","show_ajaxrenderCatalog","titleText","url","then","r","json","catalogData","d","gender","major","minor","start","limit","nextSortUrl","show_ajaxrenderList","bookListData","bookID","nowAtBookId","bookSource","show_ajaxBookSource","show_ajaxrenderBook","func"],"mappings":"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","file":"index.map","sourceRoot":"..","sourcesContent":["\r\nvar V = new Vue({\r\n    el: '#app',\r\n    data: {\r\n        show: {\r\n            index: true,\r\n            ajax: false,\r\n            searchIcon: true,\r\n            searchInput: false,\r\n            swichMybook: true,\r\n            swichFind: true,\r\n            activeMybook: true,\r\n            activeFind: false,\r\n            nobook: true,\r\n            myBookList: false,\r\n            find: false,\r\n            renderCatalog: false,\r\n            renderList: false,\r\n            renderBook: false,\r\n            BookSource: false,\r\n        },\r\n        ajax: {\r\n            titleText: '标题',\r\n            catalogData: '',\r\n            nextSortUrl: '',\r\n            bookListData: '',\r\n            nowAtBookId: '',\r\n            bookSource: {\r\n                test: '001',\r\n            },\r\n        }\r\n    },\r\n    methods: {\r\n        show_ajax: function () {\r\n            V.show.index = false;\r\n            V.show.ajax = true;\r\n        },\r\n        show_ajaxrenderCatalog: function () {\r\n            V.show_ajax();\r\n            V.show.renderCatalog = true;\r\n            V.show.renderList = false;\r\n            V.show.renderBook = false;\r\n        },\r\n        show_ajaxrenderList: function () {\r\n            console.log('渲染列表');\r\n            V.show_ajax();\r\n            V.show.renderCatalog = false;\r\n            V.show.renderList = true;\r\n            V.show.renderBook = false;\r\n        },\r\n        show_ajaxrenderBook: function () {\r\n            console.log('渲染书籍');\r\n            V.show_ajax();\r\n            V.show.renderCatalog = false;\r\n            V.show.renderList = false;\r\n            V.show.renderBook = true;\r\n        },\r\n        show_ajaxBookSource: function () {\r\n            console.log('渲染书籍');\r\n            V.show.BookSource = true;\r\n        },\r\n\r\n\r\n        show_index: function () {\r\n            V.show.index = true;\r\n            V.show.ajax = false;\r\n        },\r\n        show_indexMybook: function () {\r\n            V.show_index();\r\n            V.show.searchIcon = true;\r\n            V.show.searchInput = false;\r\n            V.show.swichMybook = true;\r\n            V.show.swichFind = true;\r\n            V.show.activeMybook = true;\r\n            V.show.activeFind = false;\r\n            V.show.nobook = true;\r\n            V.show.myBookList = false;\r\n            V.show.find = false;\r\n        },\r\n        show_indexFind: function () {\r\n            V.show_index();\r\n            V.show.searchIcon = true;\r\n            V.show.searchInput = false;\r\n            V.show.swichMybook = true;\r\n            V.show.swichFind = true;\r\n            V.show.activeMybook = false;\r\n            V.show.activeFind = true;\r\n            V.show.nobook = false;\r\n            V.show.myBookList = false;\r\n            V.show.find = true;\r\n        },\r\n        // 显示搜索框\r\n        show_searchInput: function () {\r\n            console.log('显示搜索框');\r\n            V.show.searchIcon = false;\r\n            V.show.searchInput = true;\r\n            // 为搜索框设置光标\r\n            this.$nextTick(() => {\r\n                this.$refs.searchInput.focus();\r\n            })\r\n        },\r\n        // 在搜索框按下回车\r\n        submitSearchInput: function (event) {\r\n            console.log('在搜索框按下回车')\r\n            // 取得输入值\r\n            let input = event.target.value;\r\n            console.log(input);\r\n            // 请求数据并渲染\r\n        },\r\n        // 渲染标签\r\n        renderCatalog: function (event) {\r\n            console.log('渲染标签');\r\n            let type = event.target.getAttribute('data-func');\r\n            let text = event.target.innerHTML;\r\n            console.log(type);\r\n            // 切换到渲染视图\r\n            V.show_ajaxrenderCatalog();\r\n            // 设置渲染视图的标题\r\n            V.ajax.titleText = text;\r\n            // 取得需求数据\r\n            let url = '';\r\n            if (type === 'rank') {\r\n                url = 'https://api.imhcg.cn/api/v1/zssq/ranking/gender';\r\n            } else {\r\n                url = 'https://api.imhcg.cn/api/v1/zssq/catalog';\r\n            }\r\n            this.$nextTick(() => {\r\n                fetch(url)\r\n                    .then(r => r.json())\r\n                    .then(d => {\r\n                        this.ajax.catalogData = d;\r\n                    })\r\n            })\r\n        },\r\n        // 渲染书籍列表\r\n        renderBookList: function (event) {\r\n            console.log('渲染书籍列表');\r\n            let type = event.target.getAttribute('type');\r\n            let text = event.target.innerHTML;\r\n            V.ajax.titleText = text;\r\n            console.log(type, text);\r\n            let url = '';\r\n            if (type === 'rank') {\r\n                url = 'https://api.imhcg.cn/api/v1/zssq/ranking/' + event.target.getAttribute('data-id');\r\n            } else {\r\n                let gender = event.target.getAttribute('gender');\r\n                let major = event.target.getAttribute('data-Major');\r\n                let minor = event.target.getAttribute('data-Minor');\r\n                if (!minor) minor = '';\r\n                let start = 0;\r\n                let limit = 20;\r\n                url = `https://api.imhcg.cn/api/v1/zssq/catalog/detail?gender=${gender}&major=${major}&minor=${minor}&start=${start}&limit=${limit}`;\r\n                start += 20;\r\n                V.ajax.nextSortUrl = `https://api.imhcg.cn/api/v1/zssq/catalog/detail?gender=${gender}&major=${major}&minor=${minor}&start=${start}&limit=${limit}`;\r\n            }\r\n            console.log(url);\r\n\r\n            V.show_ajaxrenderList();\r\n            this.$nextTick(() => {\r\n                fetch(url)\r\n                    .then(r => r.json())\r\n                    .then(d => {\r\n                        this.ajax.bookListData = d;\r\n                        console.log(d);\r\n                    })\r\n            })\r\n        },\r\n        //加载书籍\r\n        loadBook: function (event) {\r\n            console.log('加载书籍');\r\n            let bookID = event.target.getAttribute('bookID');\r\n            V.ajax.nowAtBookId = bookID;\r\n            let text = event.target.innerHTML;\r\n            V.ajax.titleText = text;\r\n            console.log(bookID, text);\r\n            \r\n\r\n            // 根据书籍 ID 取回书籍源\r\n            let url = `https://api.imhcg.cn/api/v1/zssq/atoc/${bookID}`\r\n            let bookSource = this.ajax.bookSource.bookID;\r\n            if (!bookSource) {\r\n                console.log('刷新源')\r\n                fetch(url)\r\n                    .then(r => r.json())\r\n                    .then(d => {\r\n                        this.ajax.bookSource[bookID] = d;\r\n                    })\r\n                    .then(() => {\r\n                        console.log(V.ajax.nowAtBookId);\r\n                        console.log(V.ajax.bookSource);\r\n                        console.log(V.ajax.bookSource[V.ajax.nowAtBookId]);\r\n                        V.show_ajaxrenderBook();\r\n                        V.show_ajaxBookSource();\r\n                    })\r\n            } else {\r\n                console.log('加载源')\r\n                V.show_ajaxBookSource();\r\n            }\r\n        },\r\n        // 阅读器功能\r\n        BookControl: function (event) {\r\n            console.log('阅读器功能');\r\n            let func = event.target.getAttribute('func');\r\n            console.log(func)\r\n        }\r\n    },\r\n})"]}